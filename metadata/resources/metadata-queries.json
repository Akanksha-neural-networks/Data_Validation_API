{
    "snowflake": "SELECT OBJECT_CONSTRUCT('engine', 'snowflake', 'metadata', ARRAY_AGG( OBJECT_CONSTRUCT( 'database', current_database(), 'schemas', SCHEMAS ) ) ) AS result FROM ( SELECT ARRAY_AGG( OBJECT_CONSTRUCT( 'schema', TABLE_SCHEMA, 'tables', TABLES ) ) AS SCHEMAS FROM ( SELECT TABLE_SCHEMA, ARRAY_AGG(TABLE_NAME) AS TABLES FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA NOT IN ('INFORMATION_SCHEMA', 'SYSADMIN', 'ACCOUNT_USAGE', 'ACCOUNT_USAGE_INTERNAL', 'SECURITY_INTEGRATION') GROUP BY TABLE_SCHEMA ) AS SUBQUERY );",
    "mysql": "SELECT JSON_OBJECT('engine', 'mysql', 'metadata', JSON_ARRAYAGG(metadata) ) AS result FROM ( SELECT JSON_OBJECT( 'database', table_schema, 'tables', tables ) AS metadata FROM ( SELECT table_schema, JSON_ARRAYAGG(table_name) AS tables FROM information_schema.tables WHERE table_schema NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys') GROUP BY table_schema ) AS subquery ) AS main_query;",
    "postgres": "SELECT JSON_ARRAYAGG(json_build_object( 'database', database_name, 'schemas', schemas )) AS result FROM ( SELECT database_name, json_agg(json_build_object( 'schema', schema_name, 'tables', tables )) AS schemas FROM ( SELECT table_catalog AS database_name, table_schema AS schema_name, json_agg(table_name) AS tables FROM information_schema.tables WHERE table_catalog NOT IN ('information_schema', 'mysql', 'performance_schema', 'sys') GROUP BY table_catalog, table_schema ) AS tables_per_schema GROUP BY database_name ) AS databases;"
}

